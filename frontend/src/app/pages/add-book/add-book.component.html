<mat-card class="mat-elevation-z4">
  <form (ngSubmit)="onSubmit()" class="add-book-form">
    <h2>Create the card</h2>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Genre</mat-label>
        <mat-select [(ngModel)]="book.genre_id" name="genre_id" (selectionChange)="onGenreChange($event.value)">
          <mat-option *ngFor="let genre of genres" [value]="genre.id">
            <img [src]="genre.image_url" width="32" height="32" class="genre-option-img">
            {{ genre.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [(ngModel)]="book.category_id" name="category_id" (selectionChange)="onCategoryChange($event.value)">
          <mat-option *ngFor="let cat of categories" [value]="cat.id">
            <span class="category-dot" [style.background]="cat.color"></span>
            {{ cat.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Title</mat-label>
        <input matInput [(ngModel)]="book.title" name="title" required>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Your name</mat-label>
        <input matInput [(ngModel)]="book.author" name="author" required>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput [(ngModel)]="book.description" name="description" rows="3"></textarea>
      </mat-form-field>
    </div>

    <div class="cover-upload">
      <label for="coverInput" class="cover-label">
        <mat-icon>image</mat-icon>
        Insert your cover
        <input 
          type="file"
          id="coverInput"
          (change)="onCoverSelected($event)"
          accept="image/*"
          hidden
        />
      </label>
      <div *ngIf="book.cover_url" class="cover-preview">
        <img [src]="book.cover_url" alt="Couverture" />
      </div>
    </div>

    <div class="submit-row">
      <button mat-raised-button color="primary" type="submit">
        Add your book
      </button>
    </div>
  </form>
</mat-card>
